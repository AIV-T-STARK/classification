Thủ thuật Excel (1)
Xin cho hỏi cách tạo bảng danh mục tạm thời trong Excel (không phải Dropdown list). Ví dụ, tôi có bảng kê ở 'Sheet1' gồm 02 cột: 'mã số' và 'tên chi tiết'. Ở 'Sheet2', tại một ô nào đó, tôi muốn hiện hộp thoại tạm thời (hộp thoại này có thể hiện toàn bộ 'tên chi tiết' mà tôi đã khai báo ở 'Sheet1'). Sau khi chọn một tên cụ thể nào đó trên hộp thoại thì hộp thoại đóng lại và thể hiện kết quả là 'mã số' tương ứng với 'tên chi tiết' mà tôi đã chọn vào ô hiện hành của 'Sheet2'.Kính mong được sự hỗ trợ của các 'chuyên gia'. Chân thành cảm ơn!
Lê Thanh Bình
Hồi âm:
Van de cua ban co the giai quyet bang cach lap trinh VBA trong Excel. Vi thoi gian han che cung nhu noi dung bai viet chi tiet rat dai, sau day minh co the huong dan ban 1 cach tong quan de giai quyet van de:- Truoc het ban mo file Excel ma ban can tao hop thoai.- Nhan to hop phim Alt+F11 de mo cua so soan thao VBA.- Khai bao 2 bien toan cuc (vi du: b1 va b2) de luu tru gia tri "ma so" va "ten chi tiet"- Trong cua so VBA project hien hanh, ban chen vao 1 Form. Trong Form nay ban chen vao mot doi tuong ComboBox, 1 button de tao nut Cancel de huy bo chon lua va dong Form lai, 1 button de tao nut OK ket thuc viec chon gia tri va dong Form lai.- Trong cua so VBA project, ban chon Sheet2, chon event Worksheet_BeforeRightClick de kich hoat Form duoc tao o tren khi nguoi dung click chuot phai vao 1 o bat ky trong Sheet2.- Trong su kien Initialize cua Form, ban tao 1 vong lap doc het cac gia tri trong cot "ma so" cua Sheet1. Cu the la ban dung method AddItem cua ComboBox de nap lan luot cac gia tri vao.- Gan gia tri cua Combox vao bien b1- Trong su kien Click cua button Cancel ban dung ham Unload de dong Form lai- Trong su kien Click cua button OK ban dung ham FindNext de tim gia tri "ten chi tiet" tuong ung voi gia tri "ma so" duoc chon trong Combox. ket qua tim duoc cua ham FindNext duoc gan vao bien b2.- Ban gan gia tri b1 vao cell da duoc click chuot phai o Sheet2 va gan b2 vao cell + offset (0,1)- Ban chon lenh "Compile VBAproject" trong menu Debug de dam bao rang tat cac cau lenh VBA duoc viet dung cu phap.Ban luu lai VBA project truoc khi thoat ra tro ve phan cua so lam viec thong thuong cua Excel. Luu y la VBA project duoc luu kem luon trong file xls ma ban dang su dung.Neu tat ca cac thao tac tren ban lam hoan hao thi khi ban click chuot phai vao 1 cell bat ky trong Sheet2, Form thiet ke tren se duoc kich hoat. Form cho phep ban chon gia tri trong Combobox sau do khi ban click vao button OK thi cac gia tri tuong ung se duoc gan vao cell hien hanh trong Sheet2.Mot diem can luu y nua la, ban phai luon luon enable macro truoc moi khi mo file xls. De bat tinh nang nay ban vao: Tool\Macro\Security.... Ban chon muc do Medium trong the Security LevelNeu ban cam thay van rat kho khan de thuc hien cong viec nay, ban co the lien lac truc tiep voi minh tai dia chi: nmthang@vung-tau.oilfield.slb.com. Minh se co gang danh thoi gian viet 1 file demo theo yeu cau cua ban trong thoi gian som nhat co the. Chuc ban vui.

