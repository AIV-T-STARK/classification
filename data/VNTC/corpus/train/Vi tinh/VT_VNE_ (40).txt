Lệnh INSERT trong asp.net khó quá (2)
Tôi đang lập trình asp.net. Vài form đầu tôi dùng lệnh insert into nó chạy bình thường. Nhưng đến form sau này nó báo lỗi. Kể cả khi tôi tạo 1 object mới và một cơ sở dữ liệu mới, hiện tượng báo lỗi vẫn xảy ra tương tự. Sau đây là một đoạn lệnh:Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click Dim sql As Stringsql = "insert into db1(Fullname) value ('"  TextFullname.Text  "')"Dim cmdChinhsach As New OleDbCommand()If Application("TSI_Cnn").State = ConnectionState.Closed Then Application("TSI_Cnn").Open()cmdChinhsach.Connection = Application("TSI_Cnn")cmdChinhsach.CommandText = sqlcmdChinhsach.ExecuteNonQuery()End Sub
Báo lỗi:Syntax error in INSERT INTO statement. Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. Exception Details: System.Data.OleDb.OleDbException: Syntax error in INSERT INTO statement.Source Error: Line 31: cmdChinhsach.Connection = Application("TSI_Cnn")Line 32: cmdChinhsach.CommandText = sqlLine 33: cmdChinhsach.ExecuteNonQuery()Line 34: End SubLine 35: End Class
Cơ sở dữ liệu của tôi là Aceess. Khó quá! Xin giúp tôi với. Cám ơn nhiều!
Trương Minh Dương
Hồi âm:
Ban da viet lap trinh nay co nhieu loi nen no khong chay nhu ban mong muon. Nhan tien day toi viet lai lap trinh nay, mong rang qua day se co the giup ban it nhieu dieu hay trong van de kho khan nay. Day la Server Side Code. Code nay dua ho so tu the inputstream va doc ho so vao trong mot string variable. Va roi sau do no loads the value vao trong mot IMAGE field in SQL Server. Ban se can phai thay doi the connection settings va the insert statement de cho no phu hop nhau. Imports System.DataImports System.Data.SqlClient Public Sub Upload(ByVal sender As Object, ByVal e As System.EventArgs) Dim b(file1.PostedFile.InputStream.Length - 1) As Byte file1.PostedFile.InputStream.Read(b, 0, file1.PostedFile.InputStream.Length) Dim con As New SqlConnection(ConfigurationSettings.AppSettings("ConnectionStringSQL")) Dim sql As String = "INSERT INTO MY_TABLE(MyID, DATABLOB) VALUES(1,@Phucusa) " Dim cmd As New SqlCommand(sql, con) Dim parmBlob As New SqlParameter("@Phucusa", SqlDbType.Image, _ b.Length, ParameterDirection.Input, False, 0, _ 0, Nothing, DataRowVersionCurrent, b)  cmd.Parameters.Add(parmBlob) con.Open() cmd.ExecuteNonQuery() con.Close()End Sub 
Phucusa
syntax SQL ban nen sua lai nhu sau: sql = "insert into db1(Fullname) values ('"  TextFullname.Text  "')". Tu khoa value phai la values. 

